#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# $Id: sdss4install 70491 2016-06-15 19:16:07Z joelbrownstein $
#
from sdss_install import __version__
from sdss_install.application import Argument
from sdss_install.install import Install
from sdss_install.install4 import Install4

options = Argument('sdss4install').options
install = Install(options=options)
install4 = Install4(logger=install.logger, options=options)

if options and options.version: print(__version__)
else:
    install4.set_ready()
    install4.set_product()
    install4.set_directory()
    install4.set_directory_install()
    install4.set_directory_work()

    if not options.module_only:
        install4.clean_directory_install()
        install4.set_svncommand()
        install4.set_exists()
        install4.fetch()

    install4.reset_options_from_config()
    install4.set_build_type()
    if not options.module_only:
        install4.logger_build_message()
        install4.make_directory_install()

    if install4.ready:
        install4.set_modules()
        install4.modules.set_ready()
        install4.modules.set_file()
        install4.modules.load_dependencies()
        install4.modules.set_keywords()
        install4.modules.set_directory()
        install4.modules.build()

    install4.set_environ()
    if not options.module_only:
        install4.build()
        install4.build_documentation()
        install4.build_package()
        if not options.keep: install4.clean()

    install4.finalize()
